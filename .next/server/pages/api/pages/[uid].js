"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/pages/[uid]";
exports.ids = ["pages/api/pages/[uid]"];
exports.modules = {

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "(api)/./pages/api/pages/[uid].js":
/*!**********************************!*\
  !*** ./pages/api/pages/[uid].js ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nasync function handler(req, res) {\n    const { uid  } = req.query;\n    const connection = await mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createConnection({\n        host: \"caboose.proxy.rlwy.net\",\n        user: \"root\",\n        password: \"mytRopuhMJFxLyFcDYDoTIojZeyqzYfj\",\n        database: \"railway\",\n        port: 49094\n    });\n    try {\n        // GET 请求 - 获取页面\n        if (req.method === \"GET\") {\n            const [rows] = await connection.execute(\"SELECT * FROM pages WHERE uid = ?\", [\n                uid\n            ]);\n            if (rows.length === 0) {\n                return res.status(404).json({\n                    error: \"页面不存在\"\n                });\n            }\n            res.status(200).json(rows[0]);\n        } else if (req.method === \"PUT\") {\n            const { title , content , password  } = req.body;\n            // 验证密码\n            const [rows1] = await connection.execute(\"SELECT password FROM pages WHERE uid = ?\", [\n                uid\n            ]);\n            if (rows1.length === 0) {\n                return res.status(404).json({\n                    error: \"页面不存在\"\n                });\n            }\n            if (rows1[0].password !== password) {\n                return res.status(403).json({\n                    error: \"密码错误\"\n                });\n            }\n            // 更新页面\n            await connection.execute(\"UPDATE pages SET title = ?, content = ?, updated_at = CURRENT_TIMESTAMP WHERE uid = ?\", [\n                title,\n                content,\n                uid\n            ]);\n            res.status(200).json({\n                success: true\n            });\n        } else if (req.method === \"PATCH\") {\n            const { is_assigned , is_sold  } = req.body;\n            // 构建更新语句\n            let updateFields = [];\n            let updateValues = [];\n            if (is_assigned !== undefined) {\n                updateFields.push(\"is_assigned = ?\");\n                updateValues.push(is_assigned);\n            }\n            if (is_sold !== undefined) {\n                updateFields.push(\"is_sold = ?\");\n                updateValues.push(is_sold);\n            }\n            // 如果没有要更新的字段\n            if (updateFields.length === 0) {\n                return res.status(400).json({\n                    error: \"没有提供要更新的字段\"\n                });\n            }\n            // 添加更新时间\n            updateFields.push(\"updated_at = CURRENT_TIMESTAMP\");\n            // 执行更新\n            const query = `UPDATE pages SET ${updateFields.join(\", \")} WHERE uid = ?`;\n            updateValues.push(uid);\n            const [result] = await connection.execute(query, updateValues);\n            if (result.affectedRows === 0) {\n                return res.status(404).json({\n                    error: \"页面不存在\"\n                });\n            }\n            res.status(200).json({\n                success: true\n            });\n        } else {\n            res.status(405).json({\n                error: \"方法不允许\"\n            });\n        }\n    } catch (error) {\n        console.error(\"操作失败:\", error);\n        res.status(500).json({\n            error: \"服务器错误\"\n        });\n    } finally{\n        await connection.end();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvcGFnZXMvW3VpZF0uanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1DO0FBRXBCLGVBQWVDLE9BQU8sQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEVBQUU7SUFDOUMsTUFBTSxFQUFFQyxHQUFHLEdBQUUsR0FBR0YsR0FBRyxDQUFDRyxLQUFLO0lBRXpCLE1BQU1DLFVBQVUsR0FBRyxNQUFNTixzRUFBc0IsQ0FBQztRQUM5Q1EsSUFBSSxFQUFFLHdCQUF3QjtRQUM5QkMsSUFBSSxFQUFFLE1BQU07UUFDWkMsUUFBUSxFQUFFLGtDQUFrQztRQUM1Q0MsUUFBUSxFQUFFLFNBQVM7UUFDbkJDLElBQUksRUFBRSxLQUFLO0tBQ1osQ0FBQztJQUVGLElBQUk7UUFDRixnQkFBZ0I7UUFDaEIsSUFBSVYsR0FBRyxDQUFDVyxNQUFNLEtBQUssS0FBSyxFQUFFO1lBQ3hCLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLEdBQUcsTUFBTVIsVUFBVSxDQUFDUyxPQUFPLENBQ3JDLG1DQUFtQyxFQUNuQztnQkFBQ1gsR0FBRzthQUFDLENBQ047WUFFRCxJQUFJVSxJQUFJLENBQUNFLE1BQU0sS0FBSyxDQUFDLEVBQUU7Z0JBQ3JCLE9BQU9iLEdBQUcsQ0FBQ2MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7b0JBQUVDLEtBQUssRUFBRSxPQUFPO2lCQUFFLENBQUMsQ0FBQztZQUNsRCxDQUFDO1lBRURoQixHQUFHLENBQUNjLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDSixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoQyxPQUVLLElBQUlaLEdBQUcsQ0FBQ1csTUFBTSxLQUFLLEtBQUssRUFBRTtZQUM3QixNQUFNLEVBQUVPLEtBQUssR0FBRUMsT0FBTyxHQUFFWCxRQUFRLEdBQUUsR0FBR1IsR0FBRyxDQUFDb0IsSUFBSTtZQUU3QyxPQUFPO1lBQ1AsTUFBTSxDQUFDUixLQUFJLENBQUMsR0FBRyxNQUFNUixVQUFVLENBQUNTLE9BQU8sQ0FDckMsMENBQTBDLEVBQzFDO2dCQUFDWCxHQUFHO2FBQUMsQ0FDTjtZQUVELElBQUlVLEtBQUksQ0FBQ0UsTUFBTSxLQUFLLENBQUMsRUFBRTtnQkFDckIsT0FBT2IsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBRUMsS0FBSyxFQUFFLE9BQU87aUJBQUUsQ0FBQyxDQUFDO1lBQ2xELENBQUM7WUFFRCxJQUFJTCxLQUFJLENBQUMsQ0FBQyxDQUFDLENBQUNKLFFBQVEsS0FBS0EsUUFBUSxFQUFFO2dCQUNqQyxPQUFPUCxHQUFHLENBQUNjLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO29CQUFFQyxLQUFLLEVBQUUsTUFBTTtpQkFBRSxDQUFDLENBQUM7WUFDakQsQ0FBQztZQUVELE9BQU87WUFDUCxNQUFNYixVQUFVLENBQUNTLE9BQU8sQ0FDdEIsdUZBQXVGLEVBQ3ZGO2dCQUFDSyxLQUFLO2dCQUFFQyxPQUFPO2dCQUFFakIsR0FBRzthQUFDLENBQ3RCLENBQUM7WUFFRkQsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRUssT0FBTyxFQUFFLElBQUk7YUFBRSxDQUFDLENBQUM7UUFDMUMsT0FFSyxJQUFJckIsR0FBRyxDQUFDVyxNQUFNLEtBQUssT0FBTyxFQUFFO1lBQy9CLE1BQU0sRUFBRVcsV0FBVyxHQUFFQyxPQUFPLEdBQUUsR0FBR3ZCLEdBQUcsQ0FBQ29CLElBQUk7WUFFekMsU0FBUztZQUNULElBQUlJLFlBQVksR0FBRyxFQUFFO1lBQ3JCLElBQUlDLFlBQVksR0FBRyxFQUFFO1lBRXJCLElBQUlILFdBQVcsS0FBS0ksU0FBUyxFQUFFO2dCQUM3QkYsWUFBWSxDQUFDRyxJQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQztnQkFDckNGLFlBQVksQ0FBQ0UsSUFBSSxDQUFDTCxXQUFXLENBQUMsQ0FBQztZQUNqQyxDQUFDO1lBRUQsSUFBSUMsT0FBTyxLQUFLRyxTQUFTLEVBQUU7Z0JBQ3pCRixZQUFZLENBQUNHLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDakNGLFlBQVksQ0FBQ0UsSUFBSSxDQUFDSixPQUFPLENBQUMsQ0FBQztZQUM3QixDQUFDO1lBRUQsYUFBYTtZQUNiLElBQUlDLFlBQVksQ0FBQ1YsTUFBTSxLQUFLLENBQUMsRUFBRTtnQkFDN0IsT0FBT2IsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztvQkFBRUMsS0FBSyxFQUFFLFlBQVk7aUJBQUUsQ0FBQyxDQUFDO1lBQ3ZELENBQUM7WUFFRCxTQUFTO1lBQ1RPLFlBQVksQ0FBQ0csSUFBSSxDQUFDLGdDQUFnQyxDQUFDLENBQUM7WUFFcEQsT0FBTztZQUNQLE1BQU14QixLQUFLLEdBQUcsQ0FBQyxpQkFBaUIsRUFBRXFCLFlBQVksQ0FBQ0ksSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQztZQUN6RUgsWUFBWSxDQUFDRSxJQUFJLENBQUN6QixHQUFHLENBQUMsQ0FBQztZQUV2QixNQUFNLENBQUMyQixNQUFNLENBQUMsR0FBRyxNQUFNekIsVUFBVSxDQUFDUyxPQUFPLENBQUNWLEtBQUssRUFBRXNCLFlBQVksQ0FBQztZQUU5RCxJQUFJSSxNQUFNLENBQUNDLFlBQVksS0FBSyxDQUFDLEVBQUU7Z0JBQzdCLE9BQU83QixHQUFHLENBQUNjLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO29CQUFFQyxLQUFLLEVBQUUsT0FBTztpQkFBRSxDQUFDLENBQUM7WUFDbEQsQ0FBQztZQUVEaEIsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRUssT0FBTyxFQUFFLElBQUk7YUFBRSxDQUFDLENBQUM7UUFDMUMsT0FDSztZQUNIcEIsR0FBRyxDQUFDYyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztnQkFBRUMsS0FBSyxFQUFFLE9BQU87YUFBRSxDQUFDLENBQUM7UUFDM0MsQ0FBQztJQUNILEVBQUUsT0FBT0EsS0FBSyxFQUFFO1FBQ2RjLE9BQU8sQ0FBQ2QsS0FBSyxDQUFDLE9BQU8sRUFBRUEsS0FBSyxDQUFDLENBQUM7UUFDOUJoQixHQUFHLENBQUNjLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1lBQUVDLEtBQUssRUFBRSxPQUFPO1NBQUUsQ0FBQyxDQUFDO0lBQzNDLENBQUMsUUFBUztRQUNSLE1BQU1iLFVBQVUsQ0FBQzRCLEdBQUcsRUFBRSxDQUFDO0lBQ3pCLENBQUM7QUFDSCxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2lzaDIvLi9wYWdlcy9hcGkvcGFnZXMvW3VpZF0uanM/ZmYxZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXlzcWwgZnJvbSAnbXlzcWwyL3Byb21pc2UnO1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHsgdWlkIH0gPSByZXEucXVlcnk7XG4gIFxuICBjb25zdCBjb25uZWN0aW9uID0gYXdhaXQgbXlzcWwuY3JlYXRlQ29ubmVjdGlvbih7XG4gICAgaG9zdDogJ2NhYm9vc2UucHJveHkucmx3eS5uZXQnLFxuICAgIHVzZXI6ICdyb290JyxcbiAgICBwYXNzd29yZDogJ215dFJvcHVoTUpGeEx5RmNEWURvVElvalpleXF6WWZqJyxcbiAgICBkYXRhYmFzZTogJ3JhaWx3YXknLFxuICAgIHBvcnQ6IDQ5MDk0LFxuICB9KTtcblxuICB0cnkge1xuICAgIC8vIEdFVCDor7fmsYIgLSDojrflj5bpobXpnaJcbiAgICBpZiAocmVxLm1ldGhvZCA9PT0gJ0dFVCcpIHtcbiAgICAgIGNvbnN0IFtyb3dzXSA9IGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZShcbiAgICAgICAgJ1NFTEVDVCAqIEZST00gcGFnZXMgV0hFUkUgdWlkID0gPycsXG4gICAgICAgIFt1aWRdXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAocm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICfpobXpnaLkuI3lrZjlnKgnIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihyb3dzWzBdKTtcbiAgICB9XG4gICAgLy8gUFVUIOivt+axgiAtIOabtOaWsOmhtemdolxuICAgIGVsc2UgaWYgKHJlcS5tZXRob2QgPT09ICdQVVQnKSB7XG4gICAgICBjb25zdCB7IHRpdGxlLCBjb250ZW50LCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgICBcbiAgICAgIC8vIOmqjOivgeWvhueggVxuICAgICAgY29uc3QgW3Jvd3NdID0gYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlKFxuICAgICAgICAnU0VMRUNUIHBhc3N3b3JkIEZST00gcGFnZXMgV0hFUkUgdWlkID0gPycsXG4gICAgICAgIFt1aWRdXG4gICAgICApO1xuICAgICAgXG4gICAgICBpZiAocm93cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICfpobXpnaLkuI3lrZjlnKgnIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAocm93c1swXS5wYXNzd29yZCAhPT0gcGFzc3dvcmQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgZXJyb3I6ICflr4bnoIHplJnor68nIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmm7TmlrDpobXpnaJcbiAgICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZShcbiAgICAgICAgJ1VQREFURSBwYWdlcyBTRVQgdGl0bGUgPSA/LCBjb250ZW50ID0gPywgdXBkYXRlZF9hdCA9IENVUlJFTlRfVElNRVNUQU1QIFdIRVJFIHVpZCA9ID8nLFxuICAgICAgICBbdGl0bGUsIGNvbnRlbnQsIHVpZF1cbiAgICAgICk7XG4gICAgICBcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KTtcbiAgICB9XG4gICAgLy8gUEFUQ0gg6K+35rGCIC0g5pu05paw6aG16Z2i54q25oCBXG4gICAgZWxzZSBpZiAocmVxLm1ldGhvZCA9PT0gJ1BBVENIJykge1xuICAgICAgY29uc3QgeyBpc19hc3NpZ25lZCwgaXNfc29sZCB9ID0gcmVxLmJvZHk7XG4gICAgICBcbiAgICAgIC8vIOaehOW7uuabtOaWsOivreWPpVxuICAgICAgbGV0IHVwZGF0ZUZpZWxkcyA9IFtdO1xuICAgICAgbGV0IHVwZGF0ZVZhbHVlcyA9IFtdO1xuICAgICAgXG4gICAgICBpZiAoaXNfYXNzaWduZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cGRhdGVGaWVsZHMucHVzaCgnaXNfYXNzaWduZWQgPSA/Jyk7XG4gICAgICAgIHVwZGF0ZVZhbHVlcy5wdXNoKGlzX2Fzc2lnbmVkKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGlzX3NvbGQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cGRhdGVGaWVsZHMucHVzaCgnaXNfc29sZCA9ID8nKTtcbiAgICAgICAgdXBkYXRlVmFsdWVzLnB1c2goaXNfc29sZCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIOWmguaenOayoeacieimgeabtOaWsOeahOWtl+autVxuICAgICAgaWYgKHVwZGF0ZUZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICfmsqHmnInmj5DkvpvopoHmm7TmlrDnmoTlrZfmrrUnIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyDmt7vliqDmm7TmlrDml7bpl7RcbiAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCd1cGRhdGVkX2F0ID0gQ1VSUkVOVF9USU1FU1RBTVAnKTtcbiAgICAgIFxuICAgICAgLy8g5omn6KGM5pu05pawXG4gICAgICBjb25zdCBxdWVyeSA9IGBVUERBVEUgcGFnZXMgU0VUICR7dXBkYXRlRmllbGRzLmpvaW4oJywgJyl9IFdIRVJFIHVpZCA9ID9gO1xuICAgICAgdXBkYXRlVmFsdWVzLnB1c2godWlkKTtcbiAgICAgIFxuICAgICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGUocXVlcnksIHVwZGF0ZVZhbHVlcyk7XG4gICAgICBcbiAgICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAn6aG16Z2i5LiN5a2Y5ZyoJyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlIH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICfmlrnms5XkuI3lhYHorrgnIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfmk43kvZzlpLHotKU6JywgZXJyb3IpO1xuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICfmnI3liqHlmajplJnor68nIH0pO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZW5kKCk7XG4gIH1cbn0iXSwibmFtZXMiOlsibXlzcWwiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwidWlkIiwicXVlcnkiLCJjb25uZWN0aW9uIiwiY3JlYXRlQ29ubmVjdGlvbiIsImhvc3QiLCJ1c2VyIiwicGFzc3dvcmQiLCJkYXRhYmFzZSIsInBvcnQiLCJtZXRob2QiLCJyb3dzIiwiZXhlY3V0ZSIsImxlbmd0aCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsInRpdGxlIiwiY29udGVudCIsImJvZHkiLCJzdWNjZXNzIiwiaXNfYXNzaWduZWQiLCJpc19zb2xkIiwidXBkYXRlRmllbGRzIiwidXBkYXRlVmFsdWVzIiwidW5kZWZpbmVkIiwicHVzaCIsImpvaW4iLCJyZXN1bHQiLCJhZmZlY3RlZFJvd3MiLCJjb25zb2xlIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/pages/[uid].js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/pages/[uid].js"));
module.exports = __webpack_exports__;

})();